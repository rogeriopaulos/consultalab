{% extends "allauth/layouts/entrance.html" %}

{% load i18n %}
{% load allauth %}

{% block head_title %}
  {% trans "Change Password" %}
{% endblock head_title %}
{% block content %}
  <div class="card-header">
    {% if token_fail %}
      <h2 class="card-title">Link Inválido</h2>
      <p class="card-description">O link para redefinir senha não é válido ou expirou</p>
    {% else %}
      <h2 class="card-title">Nova Senha</h2>
      <p class="card-description">Digite sua nova senha para completar a redefinição</p>
    {% endif %}
  </div>
  <div class="card-content">
    {% if token_fail %}
      <div class="verification-info">
        <p>
          {% blocktrans %}O link para redefinir senha era inválido, possivelmente porque já foi usado anteriormente.{% endblocktrans %}
        </p>
      </div>
      <div class="cl-divider">
        <span>ou</span>
      </div>
      {% url 'account_reset_password' as passwd_reset_url %}
      {% setvar reset_link %}
      <a href="{{ passwd_reset_url }}" class="text-decoration-none fw-bold">
      {% endsetvar %}
      {% setvar end_reset_link %}
    </a>
  {% endsetvar %}
  <p class="signup-link">{{ reset_link }}Solicitar nova redefinição de senha{{ end_reset_link }}</p>
  {% setvar login_link %}
  <a href="{% url 'account_login' %}" class="text-decoration-none fw-bold">
  {% endsetvar %}
  {% setvar end_login_link %}
</a>
{% endsetvar %}
<p class="signup-link">Ou {{ login_link }}voltar ao login{{ end_login_link }}</p>
{% else %}
{% element form method="post" action=action_url tags="entrance,password_reset" %}
{% slot body %}
{% csrf_token %}
{{ redirect_field }}
{% element fields form=form unlabeled=True %}
{% endelement %}
{% endslot %}
{% slot actions %}
{% element button type="submit" name="action" tags="prominent,password_reset" %}
{% trans 'Alterar Senha' %}
{% endelement %}
{% endslot %}
{% endelement %}
<div class="mt-2">
  {% element button type="submit" form="logout-from-stage" tags="link,cancel,secondary" %}
  {% translate "Cancelar" %}
{% endelement %}
</div>
<div class="help-text">
  <p>
    <strong>Dica:</strong> Escolha uma senha forte com pelo menos 8 caracteres,
    incluindo letras, números e símbolos.
  </p>
</div>
{% endif %}
</div>
{% if not cancel_url %}
  <form id="logout-from-stage"
        method="post"
        action="{% url 'account_logout' %}">
    <input type="hidden" name="next" value="{% url 'account_login' %}" />
    {% csrf_token %}
  </form>
{% endif %}
{% endblock content %}
